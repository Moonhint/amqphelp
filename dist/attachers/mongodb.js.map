{"version":3,"sources":["../../app/attachers/mongodb.js"],"names":["module","exports","MongoDB","create","queue_name","schema","amqp","pre","next","actions","send","update","self","post","id","_conditions","_id","_update","delete"],"mappings":";;AACA;;;;;;AAEAA,OAAOC,OAAP,GAAiB,MAAMC,OAAN,wBAA0B;;AAEvCC,WAAOC,UAAP,EAAmBC,MAAnB,EAA2BC,IAA3B,EAAgC;AAC5BD,eAAOE,GAAP,CAAW,MAAX,EAAmB,UAASC,IAAT,EAAc;AAC7BF,iBAAKG,OAAL,CAAaC,IAAb,CAAkBN,UAAlB,EAA8B,IAA9B;AACAI;AACH,SAHD;AAIH;;AAEDG,WAAOP,UAAP,EAAmBC,MAAnB,EAA2BC,IAA3B,EAAgC;AAC5B,YAAIM,OAAO,IAAX;AACAP,eAAOQ,IAAP,CAAY,QAAZ,EAAsB,UAASL,IAAT,EAAc;AAChCF,iBAAKG,OAAL,CAAaC,IAAb,CAAkBN,UAAlB,EAA8B;AAC1BU,oBAAIF,KAAKG,WAAL,CAAiBC,GADK;AAE1BL,wBAAQC,KAAKK;AAFa,aAA9B;AAIAT;AACH,SAND;AAOH;;AAEDU,WAAOd,UAAP,EAAmBC,MAAnB,EAA2BC,IAA3B,EAAgC;AAC5BD,eAAOQ,IAAP,CAAY,QAAZ,EAAsB,UAASL,IAAT,EAAc;AAChCF,iBAAKG,OAAL,CAAaC,IAAb,CAAkBN,UAAlB,EAA8B,IAA9B;AACAI;AACH,SAHD;AAIH;;AAzBsC,CAA3C,C,CAHA","file":"mongodb.js","sourcesContent":["// const Bind = require('./bind.js')\r\nimport Bind from './bind.js'\r\n\r\nmodule.exports = class MongoDB extends Bind{\r\n\r\n    create(queue_name, schema, amqp){\r\n        schema.pre('save', function(next){\r\n            amqp.actions.send(queue_name, this)\r\n            next();\r\n        })\r\n    }\r\n    \r\n    update(queue_name, schema, amqp){\r\n        let self = this;\r\n        schema.post('update', function(next){\r\n            amqp.actions.send(queue_name, {\r\n                id: self._conditions._id,\r\n                update: self._update\r\n            })\r\n            next();\r\n        })\r\n    }\r\n\r\n    delete(queue_name, schema, amqp){\r\n        schema.post('remove', function(next){\r\n            amqp.actions.send(queue_name, this)\r\n            next();\r\n        })\r\n    }\r\n\r\n}"]}